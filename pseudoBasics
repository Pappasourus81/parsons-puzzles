<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Code Shuffler ‚Äì Syntax and Data Types</title>
<style>
  :root{
    --bg:#f6f8fb;
    --card:#ffffff;
    --accent:#0b66ff;
    --muted:#6b7280;
    --good:#d1fae5;
    --bad:#fee2e2;
    --bank-gap:8px;
    --shadow: 0 6px 18px rgba(13,30,60,0.08);
    --radius:12px;
  }
  html,body{height:100%;margin:0;font-family:Inter,Segoe UI,Arial,sans-serif;background:linear-gradient(180deg,#f8fbff,#f6f8fb);}
  .wrap{max-width:980px;margin:28px auto;padding:20px;}
  header{display:flex;align-items:center;gap:16px;margin-bottom:16px}
  h1{font-size:20px;margin:0;color:#07203a}
  .meta{color:var(--muted);font-size:13px}
  .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;margin-bottom:16px}
  .description{background:linear-gradient(90deg,#ffffff,#fbfdff);border-radius:10px;padding:12px;border:1px solid #e6eefc}
  .pseudocode{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Courier New", monospace;background:#0f1724;color:#e6eefc;padding:12px;border-radius:8px;margin-top:12px;white-space:pre;line-height:1.6;display:block;}
  .line{display:block}
  .controls{display:flex;gap:8px;align-items:center;margin-top:12px;flex-wrap:wrap}
  button{background:var(--accent);color:white;border:none;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600;box-shadow:0 6px 12px rgba(11,102,255,0.12)}
  button.secondary{background:#eef3ff;color:var(--accent);box-shadow:none}
  .bank{display:flex;flex-wrap:wrap;gap:var(--bank-gap);margin-top:12px}
  .token{display:inline-block;padding:8px 10px;border-radius:8px;background:#fff;border:1px solid #e6eefc;cursor:grab;box-shadow:0 4px 10px rgba(11,102,255,0.06);min-width:36px;text-align:center;color:#07203a}
  .blank{display:inline-block;min-width:60px;padding:6px 8px;border-radius:6px;background:rgba(255,255,255,0.06);border:1px dashed rgba(255,255,255,0.2);margin:0 4px;vertical-align:middle;color:#e6eefc;}
  .blank.correct{background:var(--good);color:#064e3b;border-style:solid;border-color:#86efac}
  .blank.incorrect{background:var(--bad);color:#7f1d1d;border-style:solid;border-color:#fca5a5}
  .placed-clone{display:inline-block;padding:6px 8px;border-radius:6px;background:#fff;color:#07203a;border:1px solid #e6eefc;box-shadow:0 4px 10px rgba(2,6,23,0.06);min-width:36px;text-align:center;font-weight:600;}
  .status{margin-top:12px;font-weight:600}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>Code Shuffler ‚Äì Syntax and Data Types</h1>
  </header>

  <section class="card">
    <div id="puzzleMeta" class="description"></div>
    <pre id="codeArea" class="pseudocode"></pre>
    <div class="bank-wrap card">
      <strong>Token bank</strong>
      <div id="bank" class="bank"></div>
    </div>
    <div class="controls">
      <button id="prevBtn" class="secondary">‚óÄ Prev</button>
      <button id="nextBtn" class="secondary">Next ‚ñ∂</button>
      <label for="puzzleSelect" style="margin-left:6px;color:#555;font-weight:600">Go to:</label>
      <select id="puzzleSelect"></select>
      <div style="flex:1"></div>
      <button id="submitBtn">Submit</button>
      <button id="resetBtn" class="secondary">Reset</button>
    </div>
    <div id="status" class="status"></div>
  </section>
</div>

<script>
const puzzles = [
  {
    title: "Output a greeting",
    description: "No input. Task: Write pseudocode that outputs the message \"Welcome to class\".",
    lines: ["___1___ ___2___Welcome to class___3___"],
    bank: ["OUTPUT", "PRINT", "DISPLAY", '"', "'", ":", "(", ")", "Welcome to class"],
    answers: {"1":"OUTPUT","2":'"',"3":'"'}
  },
  {
    title: "Ask for name and display it",
    description: "Input: a user's name. Task: Read the name and then output it in a sentence.",
    lines: ["___1___ Name", "___2___ \"Hello, \" , ___3___"],
    bank: ["INPUT","READ","OUTPUT","PRINT","Name","'","\"","=","+"],
    answers: {"1":"INPUT","2":"OUTPUT","3":"Name"}
  },
  {
    title: "Calculate total price",
    description: "No input. Task: Assign 20 to Price and 5 to Quantity, then compute Total = Price * Quantity.",
    lines: ["Price ___1___ 20", "Quantity ___2___ 5", "Total ___3___ Price ___4___ Quantity"],
    bank: ["‚Üê","=","*","+","-","/","Price","Quantity","Total","20","5"],
    answers: {"1":"‚Üê","2":"‚Üê","3":"‚Üê","4":"*"}
  },
  {
    title: "Combine text and number output",
    description: "No input. Task: Create variables Name=\"Maya\" and Score=45, then output 'Maya scored 45 points'.",
    lines: ["Name ___1___ ___2___Maya___3___", "Score ___4___ 45", "___5___ Name , \" scored \" , Score , \" points\""],
    bank: ["‚Üê","=","OUTPUT","PRINT","'","\"","Name","Score","45","points"],
    answers: {"1":"‚Üê","2":'"',"3":'"',"4":"‚Üê","5":"OUTPUT"}
  },
  {
    title: "Demonstrate CHAR vs STRING",
    description: "No input. Task: Declare Char='B' and Word=\"B\". Output them separated by ' and '.",
    lines: ["Char ___1___ 'B'", "Word ___2___ \"B\"", "___3___ Char , \" and \" , Word"],
    bank: ["‚Üê","=","OUTPUT","DISPLAY","PRINT","Char","Word","'","\""],
    answers: {"1":"‚Üê","2":"‚Üê","3":"OUTPUT"}
  },
  {
    title: "Use DIV and MOD",
    description: "No input. Task: Given Total=25, calculate Quotient=Total DIV 6 and Remainder=Total MOD 6.",
    lines: ["Total ___1___ 25","Quotient ___2___ Total ___3___ 6","Remainder ___4___ Total ___5___ 6"],
    bank: ["‚Üê","=","DIV","MOD","/","6","25","%","//"],
    answers: {"1":"‚Üê","2":"‚Üê","3":"DIV","4":"‚Üê","5":"MOD"}
  },
  {
    title: "Substring extraction",
    description: "Input: Text. Task: Assign Part=SUBSTRING(Text,3,2) and output Part.",
    lines: ["INPUT Text","Part ___1___ ___2___ ___3___ Text ___4___ 3 ___5___ 2 ___6___","___7___ Part"],
    bank: ["‚Üê","=","SUBSTRING","OUTPUT","PRINT","(","Text",",",")","3","2"],
    answers: {"1":"‚Üê","2":"SUBSTRING","3":"(","4":",","5":",","6":")","7":"OUTPUT"}
  },
  {
    title: "Rounding a calculated value",
    description: "No input. Task: Assign A=5.3 and B=2.7, compute Avg=(A+B)/2, then Result=ROUND(Avg).",
    lines: ["A ___1___ 5.3","B ___2___ 2.7","Avg ___3___ ( A ___4___ B ) / 2","Result ___5___ ___6___ ___7___ Avg ___8___"],
    bank: ["‚Üê","=","ROUND","AVG","A","B","+","-","(","/","2",")"],
    answers: {"1":"‚Üê","2":"‚Üê","3":"‚Üê","4":"+","5":"‚Üê","6":"ROUND","7":"(","8":")"}
  },
  {
    title: "Concatenation challenge",
    description: "No input. Task: Recreate the line OUTPUT \"Result: \" , X , \" + \" , Y , \" = \" , X + Y. Declare X=4, Y=7 first.",
    lines: ["X ___1___ 4","Y ___2___ 7","___3___ \"Result: \" , X , \" + \" , Y , \" = \" , X ___4___ Y"],
    bank: ["‚Üê","=","OUTPUT","DISPLAY","PRINT","+","-","*","/","X","Y","\"","'","Result:"],
    answers: {"1":"‚Üê","2":"‚Üê","3":"OUTPUT","4":"+"}
  },
  {
    title: "Advanced string and number mix",
    description: "No input. Task: Rebuild full code: Text=\"X12Y\", NumStr=SUBSTRING(Text,2,2), Num=ROUND(NumStr) + 3, OUTPUT Num.",
    lines: ["Text ___1___ ___2___X12Y___3___","NumStr ___4___ ___5___ ___6___ Text ___7___ 2 ___8___ 2 ___9___","Num ___10___ ___11___ ___12___ NumStr ___13___ ___14___ 3","___15___ Num"],
    bank: ["‚Üê","=","SUBSTRING","ROUND","OUTPUT","(","Text",",",")","+","-","*","2","3","NumStr","Num","\"","'"],
    answers: {"1":"‚Üê","2":'"',"3":'"',"4":"‚Üê","5":"SUBSTRING","6":"(","7":",","8":",","9":")","10":"‚Üê","11":"ROUND","12":"(","13":")","14":"+","15":"OUTPUT"}
  }
];

let puzzleIndex = 0;
let selectedTokenValue = null;
const bankEl = document.getElementById('bank');
const codeArea = document.getElementById('codeArea');
const metaEl = document.getElementById('puzzleMeta');
const selectEl = document.getElementById('puzzleSelect');
const submitBtn = document.getElementById('submitBtn');
const resetBtn = document.getElementById('resetBtn');
const nextBtn = document.getElementById('nextBtn');
const prevBtn = document.getElementById('prevBtn');
const statusEl = document.getElementById('status');

function escapeHtml(s){return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;');}
function shuffleArray(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}
function clearSelection(){document.querySelectorAll('.token.selected').forEach(el=>el.classList.remove('selected'));selectedTokenValue=null;}

function populatePuzzleSelect(){
  selectEl.innerHTML = '';
  puzzles.forEach((p,i)=>{
    const opt=document.createElement('option');
    opt.value=i; opt.textContent=`${i+1}. ${p.title}`;
    selectEl.appendChild(opt);
  });
}

function renderPuzzle(index){
  clearSelection(); statusEl.textContent=''; puzzleIndex=index; selectEl.value=index;
  const p=puzzles[index];
  metaEl.innerHTML=`<strong>${p.title}</strong><br><small>${p.description}</small>`;
  let rendered='';
  for(const line of p.lines){
    rendered += line.replace(/___(\d+)___/g,(_,n)=>`<span class='blank' data-blank='${n}'>___${n}___</span>`) + "\n";
  }
  codeArea.innerHTML=rendered;
  bankEl.innerHTML='';
  const bankTokens=shuffleArray(p.bank.slice());
  for(const t of bankTokens){
    const token=document.createElement('div');
    token.className='token'; token.dataset.value=t; token.textContent=t;
    token.draggable=true; token.tabIndex=0;
    token.onclick=()=>{clearSelection();token.classList.add('selected');selectedTokenValue=t;};
    token.addEventListener('dragstart',ev=>{ev.dataTransfer.setData('text/plain',t);});
    bankEl.appendChild(token);
  }
  document.querySelectorAll('.blank').forEach(b=>{
    b.onclick=()=>{if(selectedTokenValue){placeValueIntoBlank(selectedTokenValue,b);}};
    b.addEventListener('drop',ev=>{ev.preventDefault();placeValueIntoBlank(ev.dataTransfer.getData('text/plain'),b);});
    b.addEventListener('dragover',ev=>ev.preventDefault());
  });
}

function placeValueIntoBlank(value,b){
  b.innerHTML=`<span class='placed-clone' data-value='${value}'>${value}</span>`;
  clearSelection();
}

function getPlacedValue(b){const c=b.querySelector('.placed-clone');return c?c.dataset.value:null;}

function validate(){
  const p=puzzles[puzzleIndex]; let all=true;
  for(const [num,ans] of Object.entries(p.answers)){
    const b=document.querySelector(`[data-blank="${num}"]`);
    const val=getPlacedValue(b);
    if(val===ans){b.classList.add('correct');b.classList.remove('incorrect');}
    else{b.classList.add('incorrect');b.classList.remove('correct');all=false;}
  }
  statusEl.textContent=all?"All correct! üéâ":"Some blanks are incorrect.";
}

function reset(){
  renderPuzzle(puzzleIndex);
}

function goNext(){puzzleIndex=(puzzleIndex+1)%puzzles.length;renderPuzzle(puzzleIndex);}
function goPrev(){puzzleIndex=(puzzleIndex-1+puzzles.length)%puzzles.length;renderPuzzle(puzzleIndex);}

populatePuzzleSelect();
renderPuzzle(0);
submitBtn.onclick=validate;
resetBtn.onclick=reset;
nextBtn.onclick=goNext;
prevBtn.onclick=goPrev;
selectEl.onchange=()=>renderPuzzle(Number(selectEl.value));
</script>
</body>
</html>
